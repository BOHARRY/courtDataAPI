# 🎯 援引判例分析準確度改進報告

## 🐛 **問題診斷**

### **用戶反饋的具體案例**：

**實際判決書引用**：
```
依保險法第53條第1項規定，如其損害額超過或等於保險人已給付之賠償金額，固得就其
賠償之範圍，代位請求賠償，如其損害額小於保險人已給付之賠償金額，則保險人所得
代位請求者，應祇以該損害額為限（最高法院65年台上字第2908號判決參照）
```

**AI 錯誤分析**：
- 核心價值：該判例涉及交通事故中雙方過失的認定，對於甲主張乙有過失的抗辯具有參考價值
- 使用時機：在討論乙的過失比例時引用，特別是甲主張乙速度過快的部分

### **問題分析**：
1. **主題偏移**：從保險代位求償偏移到交通事故過失認定
2. **過度推測**：基於有限上下文進行了不當推測
3. **缺乏證據**：沒有引用實際的上下文片段支持分析

## 🛠️ **改進措施**

### **1. 強化 AI 提示詞約束**

**新增嚴格原則**：
```
1. **嚴格基於上下文**：只基於 sampleContexts 中的實際內容進行分析，不要推測或補充
2. **保守推薦**：如果上下文不足以明確判斷該判例的適用場景，必須標記為"謹慎使用"
3. **避免過度解讀**：不要從有限的上下文中推斷過多信息
4. **具體引用內容**：在推薦理由中引用實際的上下文片段，證明你的分析
```

### **2. 增強回應格式要求**

**新的回應格式**：
```javascript
{
  "citation": "判例名稱",
  "reason": "基於上下文分析的具體推薦理由，必須引用實際的上下文片段作為證據",
  "usageStrategy": "具體使用時機和策略，僅基於上下文中明確顯示的適用場景",
  "contextEvidence": "支持此推薦的上下文片段（直接引用）", // 🆕 新增
  "uncertaintyNote": "如果上下文不足以確定適用場景，請明確說明" // 🆕 新增
}
```

### **3. 增加上下文長度**

```javascript
// 修改前：前後各200字
const contextLength = 200;

// 修改後：前後各300字，提供更多上下文
const contextLength = 300;
```

## 📊 **預期改進效果**

### **改進前（問題案例）**：
```
核心價值：該判例涉及交通事故中雙方過失的認定，對於甲主張乙有過失的抗辯具有參考價值
使用時機：在討論乙的過失比例時引用，特別是甲主張乙速度過快的部分
```

### **改進後（預期結果）**：
```
核心價值：此判例確立保險人代位求償的限制原則，當損害額小於保險給付時，保險人僅能就實際損害額代位求償
使用時機：適用於保險代位求償案件，當保險人請求金額超過實際損害時的抗辯
上下文證據："如其損害額小於保險人已給付之賠償金額，則保險人所得代位請求者，應祇以該損害額為限"
```

## 🎯 **技術實作細節**

### **1. 提示詞改進**
- **增加約束**：要求 AI 必須引用實際上下文片段
- **保守原則**：強調寧可保守也不要過度推測
- **證據要求**：每個推薦都必須有上下文證據支持

### **2. 上下文提取優化**
- **增加長度**：從前後200字增加到300字
- **更好的邊界**：確保提取完整的句子和段落
- **多樣本**：提供多個案例的上下文樣本

### **3. 質量控制機制**
- **不確定性標記**：當上下文不足時明確標記
- **證據驗證**：要求提供支持分析的具體文本片段
- **保守評級**：傾向於給出較低的信心等級

## 🧪 **測試建議**

### **1. 回歸測試**
- [ ] 重新測試 2908 號判決的分析結果
- [ ] 確認 AI 能正確識別保險代位求償主題
- [ ] 驗證不會再出現交通事故過失的錯誤推測

### **2. 邊界案例測試**
- [ ] 測試上下文不足的援引判例
- [ ] 驗證 AI 會標記為"謹慎使用"
- [ ] 確認會提供"上下文不足"的警告

### **3. 質量評估**
- [ ] 檢查每個推薦都有上下文證據支持
- [ ] 驗證推薦理由與實際引用內容一致
- [ ] 確認不會出現過度推測的情況

## 🚀 **後續優化方向**

### **短期改進**：
1. **增加上下文驗證**：檢查提取的上下文是否包含完整的法律邏輯
2. **主題一致性檢查**：確保推薦的適用場景與上下文主題一致
3. **信心度校準**：根據上下文質量調整信心等級

### **長期優化**：
1. **法律知識庫**：建立判例主題分類，輔助 AI 理解
2. **多輪驗證**：使用多個 AI 模型交叉驗證分析結果
3. **專家標註**：收集律師反饋，持續改進分析質量

## 📝 **總結**

這次改進主要解決了 AI 過度推測和缺乏證據支持的問題。通過：

1. **嚴格約束 AI 行為**：要求基於實際上下文，避免推測
2. **增加證據要求**：每個推薦都必須有上下文片段支持
3. **提升上下文質量**：增加提取長度，提供更多信息

預期能顯著提升援引判例分析的準確度和可信度，減少類似 2908 號判決的錯誤分析。
